# Функция автоматической стрельбы

## Описание
Добавлена возможность стрельбы очередью из автоматов (Galil AR, M4, AK-47) при зажатии левой кнопки мыши (ЛКМ).

## Изменения в коде

### 1. Структура Weapon
Добавлено новое поле `fireRate` (скорострельность в выстрелах в секунду):
- **Автоматы** (Galil, M4, AK47): `fireRate = 10.0f` (10 выстрелов в секунду)
- **Пистолеты и снайперские винтовки**: `fireRate = 0.0f` (не автоматические)

### 2. Новые методы Weapon

#### `bool isAutomatic() const`
Проверяет, является ли оружие автоматическим.
- Возвращает `true`, если `fireRate > 0.0f`

#### `bool canFireAutomatic() const`
Проверяет, может ли оружие произвести автоматический выстрел.
- Проверяет наличие патронов
- Проверяет, что оружие автоматическое
- Проверяет, прошло ли достаточно времени с последнего выстрела (контроль скорострельности)

### 3. Функция fireWeapon()
Вынесена общая логика стрельбы в отдельную функцию:
```cpp
void fireWeapon(Player& player, const sf::RenderWindow& window, const std::string& serverIP)
```

Функция:
- Получает активное оружие игрока
- Проверяет возможность выстрела
- Вычисляет направление к курсору мыши
- Расходует патрон
- Отправляет пакет выстрела на сервер

### 4. Обработка автоматической стрельбы в игровом цикле
В основном игровом цикле (состояние `MainScreen`) добавлена проверка:
- Проверяется, зажата ли ЛКМ (`sf::Mouse::isButtonPressed(sf::Mouse::Left)`)
- Проверяется, является ли активное оружие автоматическим
- Если условия выполнены и прошло достаточно времени с последнего выстрела, производится выстрел
- При опустошении магазина автоматически запускается перезарядка

## Поведение

### Автоматы (Galil AR, M4, AK-47)
- **Одиночный выстрел**: Клик ЛКМ → один выстрел
- **Очередь**: Зажатие ЛКМ → непрерывная стрельба со скоростью 10 выстрелов/сек
- **Автоперезарядка**: При опустошении магазина автоматически начинается перезарядка

### Пистолеты и снайперские винтовки
- **Только одиночные выстрелы**: Каждый клик ЛКМ → один выстрел
- Зажатие ЛКМ не приводит к автоматической стрельбе

## Технические детали

### Контроль скорострельности
Скорострельность контролируется через:
1. Поле `fireRate` (выстрелов в секунду)
2. Таймер `lastShotTime` (время последнего выстрела)
3. Вычисление интервала между выстрелами: `fireInterval = 1.0f / fireRate`

Для автоматов с `fireRate = 10.0f`:
- Интервал между выстрелами = 0.1 секунды (100 мс)
- Это обеспечивает плавную стрельбу очередью

### Синхронизация с сервером
- Каждый выстрел отправляется на сервер через UDP пакет `ShotPacket`
- Сервер обрабатывает выстрел и рассылает информацию всем клиентам
- Клиент не создает пули локально, а ждет подтверждения от сервера (предотвращает дублирование)

## Тестирование

### Как протестировать
1. Запустить клиент и подключиться к серверу
2. Купить автомат (Galil AR, M4 или AK-47) в магазине (клавиша B возле красного квадрата)
3. Выбрать автомат (клавиши 1-4)
4. Зажать ЛКМ и наблюдать автоматическую стрельбу
5. Проверить, что пистолеты стреляют только одиночными выстрелами

### Ожидаемое поведение
- ✅ Автоматы стреляют очередью при зажатии ЛКМ
- ✅ Скорострельность ~10 выстрелов в секунду
- ✅ Пистолеты стреляют только одиночными выстрелами
- ✅ Автоматическая перезарядка при опустошении магазина
- ✅ Стрельба не работает при открытом магазине или инвентаре

## Файлы изменены
- `Zero_Ground_client/Zero_Ground_client.cpp` - основной файл клиента
- `Zero_Ground/Zero_Ground.cpp` - основной файл сервера

## Изменения на сервере

Серверная часть получила аналогичные изменения:
1. Добавлено поле `fireRate` в структуру `Weapon`
2. Добавлены методы `isAutomatic()` и `canFireAutomatic()`
3. Создана функция `fireWeaponServer()` для обработки стрельбы
4. Добавлена проверка зажатия ЛКМ в игровом цикле для автоматической стрельбы
5. Обновление позиции `serverPlayer` для корректной работы функции стрельбы

Сервер обрабатывает стрельбу аналогично клиенту и рассылает пакеты выстрелов всем подключенным клиентам.
