# Новая система смерти и респавна

## Описание

Реализована новая система смерти с черным экраном и респавном через 5 секунд вдали от противника.

## Изменения

### 1. Визуальный эффект смерти

**Клиент (Zero_Ground_client.cpp):**
- При смерти (health <= 0) экран становится полностью черным
- На черном экране отображается красный текст "You dead" (размер 80, жирный шрифт)
- Текст центрирован по экрану

**Сервер (Zero_Ground.cpp):**
- Аналогичный эффект для серверного игрока
- Полностью черный экран с красным текстом "You dead"

### 2. Механика респавна

**Изменения в логике:**
- Добавлен 5-секундный таймер ожидания респавна
- Респавн происходит через 5 секунд после смерти
- Игрок спавнится в случайной точке карты

**Требования к позиции респавна:**
- Минимальное расстояние от противника: 1000 пикселей
- Позиция не должна пересекаться со стенами
- Максимум 100 попыток найти подходящую позицию
- При неудаче используется резервная позиция (оригинальный спавн)
- Сервер игнорирует обновления позиции от мертвого клиента для предотвращения перезаписи позиции респавна

**Алгоритм генерации позиции респавна:**
1. Генерируется случайная позиция на карте (с отступом от краев)
2. Проверяется коллизия со стенами
3. Проверяется расстояние до противника (>= 1000 пикселей)
4. Если все условия выполнены - используется эта позиция
5. Если после 100 попыток не найдена подходящая позиция - используется резервная

### 3. Технические детали

**Серверная часть (Zero_Ground.cpp):**
- При смерти игрока устанавливается флаг `serverWaitingRespawn` или `clientWaitingRespawn`
- Одновременно запускается таймер `serverRespawnTimer` или `clientRespawnTimer` через `restart()`
- Функция респавна проверяет прошло ли 5 секунд через `getElapsedTime().asSeconds() >= 5.0f`
- После истечения 5 секунд происходит респавн
- Используется `std::random_device` и `std::mt19937` для генерации случайных позиций
- Проверка коллизий через функцию `checkCollision()`
- Логирование позиции респавна и расстояния до противника

**Клиентская часть (Zero_Ground_client.cpp):**
- Отрисовка черного экрана с текстом "You dead"
- Текст центрируется с учетом его границ (`getLocalBounds()`)

## Константы

- `MAP_SIZE`: 5100.0f пикселей
- `CELL_SIZE`: 100.0f пикселей
- `MARGIN`: 100.0f пикселей (отступ от краев карты)
- Минимальное расстояние от противника: 1000.0f пикселей
- Максимум попыток генерации: 100

## Резервные позиции

Если не удается найти подходящую позицию респавна:
- Сервер: (250.0, 4850.0) - нижний левый угол
- Клиент: (4850.0, 250.0) - верхний правый угол

## Тестирование

Для тестирования новой системы:
1. Запустите сервер и клиент
2. Доведите здоровье игрока до 0
3. Проверьте, что появляется черный экран с текстом "You dead"
4. Подождите 5 секунд
5. Проверьте, что игрок респавнится в новой позиции через 5 секунд
6. Проверьте, что расстояние до противника >= 1000 пикселей

## Совместимость

Изменения совместимы с существующей системой:
- Сохранена награда за убийство ($5000)
- Сохранено восстановление здоровья до 100 HP
- Сохранена система урона и визуализации повреждений
